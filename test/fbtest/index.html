<!DOCTYPE html>
<html>
<head>
<title>Facebook Login JavaScript Example</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
</head>
<body>

<h1>CN TRAVELER</h1>

<button onclick="openModal()">open modal </button>

<br><br><br><br><br>

<button onclick="openWindow()">open the window</button>

<br><br><br><br><br>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header" style="padding:35px 50px;"></div>
        <div class="modal-body" style="padding:40px 50px;">
          <iframe src="fbtest.html"></iframe>
        </div>
        <div class="modal-footer"></div>
      </div>
    </div>
  </div> 




<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script>
  window.fbAsyncInit = function() {
    FB.init({
        // appId      : '1488704804758806',
        appId: '1670352679887073',

        cookie: true, // enable cookies to allow the server to access the session
        //xfbml: true, // parse social plugins on this page
        xfbml: false,
        version: 'v2.2', // use version 2.2
        oauth      : true
    });



    // Now that we've initialized the JavaScript SDK, we call 
    // FB.getLoginStatus().  This function gets the state of the
    // person visiting this page and can return one of three states to
    // the callback you provide.  They can be:
    //
    // 1. Logged into your app ('connected')
    // 2. Logged into Facebook, but not your app ('not_authorized')
    // 3. Not logged into Facebook and can't tell if they are logged into
    //    your app or not.
    //fb
    // These three cases are handled in the callback function.

    FB.getLoginStatus(function(response) {
        console.warn(response.status);
        // statusChangeCallback(response);
    });

};

// Load the SDK asynchronously
(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s);
    js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>


<script>

function isFacebookApp() {
    var ua = navigator.userAgent || navigator.vendor || window.opera;
    return (ua.indexOf("FBAN") > -1) || (ua.indexOf("FBAV") > -1);
}


function openModal(){
  $("#myModal").modal();
}

function openModal__(){
  FB.login(function(response){
    if (response.authResponse) {
      alert('open that modal');
      $("#myModal").modal();
    } else {
      alert('do nothing!');
    }
  });
}

function openModal_(){
    alert(isFacebookApp());
    
    if(!isFacebookApp()){
      console.info('open that modal');
      $("#myModal").modal();
    } else {
    
      var appId = '1670352679887073';
      //               var uri = window.location.href;
      //               var url = encodeURI("https://www.facebook.com/dialog/oauth?client_id="+appId+"&response_type=token");
      // window.location.href = url;
    
      FB.login(function(response){
        if (response.authResponse) {
          alert('open that modal');
          $("#myModal").modal();
        } else {
          console.log('do nothing!')
      }
    });
    }
    
}

function openWindow(){
    console.info('open that window');
    window.open('fbtest.html');
}

(function(){
var varsStr = window.location.hash.toString().slice(1),
            strArr = varsStr.split('&'),
            vars = {},
            i = 0,
            len = strArr.length,
            temp,
            params;
        for (i = 0; i < len; i++) {
            temp = strArr[i].split('=');
            vars[temp[0]] = temp[1];
        }
        if (vars.hasOwnProperty('openmodal')) {
            $("#myModal").modal();
        }
})();

</script>


</body>
</html>
